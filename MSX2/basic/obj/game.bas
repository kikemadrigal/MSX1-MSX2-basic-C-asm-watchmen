80 defint a-z
90 'gosub 11000
95 'preset (0,8*3):print #1,"Cagando mapa a page 0!!"
100 gosub 20300:gosub 20100
130 gosub 5000
520 strig(0) on:on strig gosub 5200
530 'gosub 2900
    2000 gosub 5100
    2010 gosub 2500
    2020 'gosub 3100
    2030 if mc=1 then mc=0: preset(40,100):print #1,"Mission complete!!":gosub 20300:gosub 20100
2090 goto 2000
    2300 a=usr2(0)
    2310 if re=1 then PLAY"O5 L8 V4 M8000 A A D F G2 A A A A r60 G E F D C D G R8 A2 A2 A8","o1 v4 c r8 o2 c r8 o1 v6 c r8 o2 v4 c r8 o1 c r8 o2 v6 c r8"
    2350 if re=5 then play "l10 o4 v4 g c"
    2360 if re=6 then play"t250 o5 v12 d v9 e" 
    2370 if re=7 then play "O5 L8 V4 M8000 A A D F G2 A A A A"
    2380 if re=8 then PLAY"S1M2000T150O7C32"
    2390 if re=9 then PLAY"o2 l64 t255 v10 m6500 c"
    2400 if re=10 then sound 6,5:sound 8,16:sound 12,6:sound 13,9
2420 return
    2500 on stick(0) gosub 2700,2500,2600,2500,2800,2500,2640
    2520 if pa=1 then py=py-pj
    2530 if pa=1 and py<po-10 then pj=-pj
    2540 if pa=1 and py>po then py=po:pj=0:pj=-pj:pa=0:strig(0)on
    2590 gosub 3100
    2592 if pa=0 and t5=255 then py=py+pv
    2590 if py>180 then py=180
2599 return
    2600 px=px+pv
    2610 swap p(0),p(1):ps=p(1)
    2620 'gosub 2900
2630 return
    2640 px=px-pv
    2650 swap p(2),p(3):ps=p(3)
2660 return
    2700 beep:'gosub 2900:'pset(px+8,py-1),13
    2710 'if t1=2 or t5=2 and pa=0 then ps=p(4):py=py-pv
    2720 mc=1
2750 return
    2800 beep:'gosub 2900:'pset(px+8,py-1),13
    2810 if t1=2 or t5=2 and pa=0 then ps=p(4):py=py+pv
2850 return
    2900 tx=(px+8)/8:ty=(py-1)/8
    2920 gosub 3100
    2960 PRESET(0,212-16):PRINT#1,"tx: "tx" ty: "ty" t1: "t1" "pa
    2970 tx=(px+8)/8:ty=(py+16+1)/8
    2980 gosub 3100
    2990 PRESET(0,212-8):PRINT#1,"tx: "tx" ty: "ty" t5: "t5" "py
3020 return
    3100 tx=(px+8)/8:ty=(py-1)/8
    3110 t1=m(ty,tx)
    3140 tx=(px+8)/8:ty=(py+16+1)/8
    3150 t5=m(ty,tx)
3190 return
    5000 px=16:py=160:pw=16:ph=16:pv=2:pj=0:po=py:pe=100:pa=0
    5010 dim p(6):p(0)=0:p(1)=1:p(2)=2:p(3)=3:p(4)=4:p(5)=5
    5020 pp=0:ps=1
    5030 pc=0:pe=0
5040 return
    5100 put sprite pp,(px,py),,ps
    5110 'put sprite pp+1,(px,py),11,0
5190 return
    5200 re=10: gosub 2300
    5210 po=py:pj=2:pa=1:strig(0)off
5290 return
    20000 dim m(25,31)
20010 return
20100 cls
20110 copy (0,0)-(32*8,23*8),2 to (0,0),0,tpset
20190 return
    20200 'dim  m(25,31)
    20205 md=&hd001
    20210 for f=0 to 22
        20220 for c=0 to 31
            20225 tn=peek(md):md=md+1
        20230 next c
    20240 next f
    20250 'gosub 11500
20290 return
20300 preset(0,23*8):print #1,"Saving on page 2, wait..."
20305 set page 0,2:cls
20310 FOR T=0 TO 22:READ H$:co=0
    20320 FOR I=0 TO len(H$) STEP 4
        20330 R=VAL("&H"+MID$(H$,I+1,2))   
        20340 O=VAL("&H"+MID$(H$,I+3,2))
        20350 FOR J=0 TO R
            20360 tn=O-1
            20370 if tn >=0 and tn <32 then copy (tn*8,0)-((tn*8)+8,8),1 to (co*8,T*8),2,tpset
            20380 if tn >=32 and tn <64 then copy ((tn-32)*8,8)-(((tn-32)*8)+8,8),1 to (co*8,T*8),2,tpset
            20390 if tn >=32 and tn <64 then copy ((tn-32)*8,1*8)-(((tn-32)*8)+8,(1*8)+8),1 to (co*8,T*8),2,tpset
            20400 if tn >=64 and tn <96 then copy ((tn-64)*8,2*8)-(((tn-64)*8)+8,(2*8)+8),1 to (co*8,T*8),2,tpset
            20410 if tn>=96 and tn <128 then copy ((tn-96)*8,3*8)-(((tn-96)*8)+8,(3*8)+8),1 to (co*8,T*8),2,tpset
            20420 if tn>=128 and tn <160 then copy ((tn-128)*8,4*8)-(((tn-128)*8)+8,(4*8)+8),1 to (co*8,T*8),2,tpset
            20430 if tn>=160 and tn <192 then copy ((tn-160)*8,5*8)-(((tn-160)*8)+8,(5*8)+8),1 to (co*8,T*8),2,tpset
            20440 if tn>=192 and tn <224 then copy ((tn-192)*8,6*8)-(((tn-192)*8)+8,(6*8)+8),1 to (co*8,T*8),2,tpset
            20450 if tn>=224 and tn <256 then copy ((tn-224)*8,7*8)-(((tn-224)*8)+8,(7*8)+8),1 to (co*8,T*8),2,tpset
            20455 co=co+1
        20460 NEXT J
    20470 next I
20490 next T 
20494 set page 0,0
20495 preset(0,23*8):print #1,"                         " 
20499 return       
21000 data 1ee300e4
21010 data 01e30600002803000001000209000009000a010000e300e4
21020 data 01e30b000021002209000029002a010001e3
21030 data 01e303e101000ae1010001e100c100c206e1
21040 data 00e300e400650066001000300200009000a00b00000c001c00200300000e003e
21050 data 00e300e4008500860010003001000002009200a00b00000c001c00200300000e003e
21060 data 01e400a500a6001000301000000c001c00200300000e003e
21070 data 0ae2010002e200c100c202e2010008e2
21080 data 00e300e401000009000a090000c100c20300001000300000009000a00200000e003e
21090 data 00e300e401000029002a02000028050000c100c2010000280000001000300002009200a00200000e003e
21100 data 00e300e40d0000c100c201000001000200100030030000080018002e003e
21110 data 00e300e40d0000c100c2010000210022001000300300000a001a002e003e
21120 data 0be1010001e100c100c205e1010000e100c100c202e1
21130 data 00e300e404000009000a060000c100c2080000c100c2000000e300e4
21140 data 00e300e404000029002a060000c100c2080000c100c2000000e300e4
21150 data 00e300e4030000010002070000c100c204000028020000c100c2000000e300e4
21160 data 00e300e4030000210022070000c100c2080000210022000000e300e4
21170 data 00e100e201e100c100c202e2010007e2010002e200c100c205e2
21180 data 00e300e4010000c100c207000009000a070000c100c201000009000a00e300e4
21190 data 00e300e4010000c100c20100002804000029002a070000c100c201000029002a00e300e4
21200 data 00e300e4010000c100c20a0000010002040000c100c2030000e300e4
21210 data 00e300e4010000c100c20a0000210022040000c100c2030000e300e4
21220 data 1fe1
21230 data 1fe1
21240 data 00e1006500661b0000e1
21250 data 00e1008500861b0000e1
21260 data 00e100a500a61b0000e1
21270 data 06e101000ae100c100c205e1020000e1
21280 data 00e1020000e10e0000c100c2040000e1020000e1
21290 data 00e1020000e10e0000c100c2040000e1020000e1
21300 data 00e1020000e10e0000c100c2040000e1020000e1
21310 data 01e1010000e1020002e1010000e100c100c207e1020000e1020000e1
21320 data 00e1020000e1020000e1040000c100c2060000e1020000e1020000e1
21330 data 00e1010001e1020000e1040000c100c2060000e1020000e1020000e1
21340 data 00e1020000e1020008e1050000e1020000e1020000e1
21350 data 01e1010000e1020000e1070000e1040000e1020000e1020000e1
21360 data 00e1020000e1020000e1080000e1030000e1020000e1020000e1
21370 data 00e1010001e1020002e100c100c200e1030002e100c100c200e1020000e1020000e1
21380 data 00e1020000e1050000c100c2070000c100c2030000e1020000e1
21390 data 01e1010000e1050000c100c2070000c100c201000081008200e1020000e1
21400 data 00e1020000e1050000c100c2070000c100c2010000a100a200e1020000e1
21410 data 00e1010002e100c100c200e101000be100c100c202e1020000e1
21420 data 00e1040000c100c20e0000c100c2050000e1
21430 data 01e1030000c100c20e0000c100c2050000e1
21440 data 00e1040000c100c20e0000c100c2050000e1
21450 data 1fe1
22000 data 1fe1
22010 data 1e0000e1
22020 data 0009000a1c0000e1
22030 data 0029002a1c0000e1
22040 data 03e1020003e1010007e1010003e1030000e1
22050 data 1e0000e1
22060 data 1a0004e1
22070 data 190005e1
22080 data 1be10300
22090 data 14e10a00
22100 data 10e10e00
22110 data 0be10c0004e10100
22120 data 08e10f0004e10100
22130 data 06e10e0004e10400
22140 data 03e1110004e10400
22150 data 02e10c000ae10400
22160 data 01e10d000ae1010002e1
22170 data 00e109000fe1010002e1
22180 data 0a0007e100a900aa070002e1
22190 data 05000ce100c900ca070002e1
22200 data 05000ce100e900ea070002e1
22210 data 00001ee1
22220 data 1fe1
